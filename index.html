<!DOCTYPE html>
<html lang="sk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Adlify - Lead Generation App</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'adlify-orange': '#FF6B35',
                        'adlify-pink': '#E91E63',
                        'adlify-purple': '#9C27B0',
                    }
                }
            }
        }
    </script>
    <style>
        body { font-family: 'Inter', sans-serif; }
        .gradient-bg { background: linear-gradient(135deg, #FF6B35 0%, #E91E63 50%, #9C27B0 100%); }
        .gradient-text {
            background: linear-gradient(135deg, #FF6B35 0%, #E91E63 50%, #9C27B0 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        input:focus, textarea:focus { border-color: #FF6B35 !important; box-shadow: 0 0 0 3px rgba(255, 107, 53, 0.15); }
    </style>
</head>
<body class="bg-gray-50 min-h-screen">
    <header class="gradient-bg text-white">
        <div class="max-w-7xl mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center gap-3">
                    <div class="w-10 h-10 bg-white/20 rounded-xl flex items-center justify-center">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"/>
                        </svg>
                    </div>
                    <span class="text-2xl font-bold tracking-tight">ADLIFY</span>
                </div>
                <div class="flex items-center gap-4">
                    <span id="dbStatus" class="text-sm bg-white/20 px-3 py-1 rounded-full">‚è≥ Prip√°jam...</span>
                    <button onclick="openSettings()" class="text-white/80 hover:text-white">‚öôÔ∏è Nastavenia</button>
                </div>
            </div>
        </div>
    </header>

    <div class="bg-white border-b">
        <div class="max-w-7xl mx-auto px-6 py-3">
            <div class="flex items-center gap-8 text-sm">
                <div><span class="text-gray-500">Celkom:</span> <strong id="totalLeads">0</strong></div>
                <div><span class="text-gray-500">üÜï Nov√Ωch:</span> <strong id="newLeads">0</strong></div>
                <div><span class="text-gray-500">üìß Kontakt.:</span> <strong id="contactedLeads">0</strong></div>
                <div><span class="text-gray-500">‚úÖ Klientov:</span> <strong id="convertedLeads">0</strong></div>
            </div>
        </div>
    </div>

    <main class="max-w-7xl mx-auto px-6 py-8">
        <div class="flex gap-2 mb-6">
            <button onclick="showTab('search')" id="tab-search" class="px-4 py-2 rounded-lg font-medium bg-adlify-orange text-white">üîç Vyhƒæad√°vanie</button>
            <button onclick="showTab('import')" id="tab-import" class="px-4 py-2 rounded-lg font-medium bg-gray-100 text-gray-700">üì• Import</button>
        </div>

        <div id="panel-search" class="bg-white rounded-2xl shadow-lg p-8 mb-8">
            <h1 class="text-2xl font-bold text-gray-800 mb-6">üîç Vyhƒæada≈• nov√© firmy</h1>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Remeslo</label>
                    <input type="text" id="trade" placeholder="napr. autoservis" class="w-full px-4 py-3 rounded-xl border border-gray-200 outline-none">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Mesto</label>
                    <input type="text" id="city" placeholder="napr. Bratislava" class="w-full px-4 py-3 rounded-xl border border-gray-200 outline-none">
                </div>
                <div class="flex items-end">
                    <button onclick="handleSearch()" id="searchBtn" class="w-full gradient-bg text-white font-semibold py-3 px-6 rounded-xl hover:opacity-90">üîç Vyhƒæada≈•</button>
                </div>
            </div>
        </div>

        <div id="panel-import" class="bg-white rounded-2xl shadow-lg p-8 mb-8 hidden">
            <h1 class="text-2xl font-bold text-gray-800 mb-6">üì• Import dom√©n</h1>
            <textarea id="domainList" rows="8" placeholder="hadvoservis.sk&#10;autodiskanec.sk&#10;..." class="w-full px-4 py-3 rounded-xl border border-gray-200 outline-none font-mono text-sm mb-4"></textarea>
            <button onclick="handleImport()" class="gradient-bg text-white font-semibold py-3 px-6 rounded-xl hover:opacity-90">üì• Importova≈•</button>
        </div>

        <div class="bg-white rounded-2xl shadow-lg overflow-hidden">
            <div class="px-6 py-4 border-b flex justify-between items-center">
                <h2 class="text-lg font-semibold">Leady: <span class="gradient-text" id="resultsCount">0</span></h2>
                <div class="flex gap-2">
                    <select id="statusFilter" onchange="loadLeads()" class="px-3 py-2 border rounded-lg text-sm">
                        <option value="">V≈°etky</option>
                        <option value="new">üÜï Nov√©</option>
                        <option value="ready">‚ú® Ready</option>
                        <option value="contacted">üìß Kontakt.</option>
                    </select>
                    <button onclick="loadLeads()" class="px-4 py-2 bg-gray-100 rounded-lg text-sm">üîÑ</button>
                </div>
            </div>
            <div id="leadsList"></div>
            <div id="emptyList" class="p-12 text-center text-gray-500">≈Ωiadne leady.</div>
        </div>
    </main>

    <div id="settingsModal" class="fixed inset-0 bg-black/50 flex items-center justify-center hidden z-50">
        <div class="bg-white rounded-2xl p-6 w-full max-w-lg mx-4">
            <h3 class="text-lg font-semibold mb-4">‚öôÔ∏è Nastavenia</h3>
            <label class="block text-sm font-medium text-gray-700 mb-2">Claude API Key</label>
            <input type="password" id="settingsApiKey" placeholder="sk-ant-api03-..." class="w-full px-4 py-3 rounded-xl border mb-4 font-mono text-sm">
            <div class="flex gap-3">
                <button onclick="saveSettings()" class="flex-1 gradient-bg text-white font-semibold py-2 rounded-xl">Ulo≈æi≈•</button>
                <button onclick="closeSettings()" class="px-4 py-2 bg-gray-100 rounded-xl">Zru≈°i≈•</button>
            </div>
        </div>
    </div>

    <div id="statusModal" class="fixed inset-0 bg-black/50 flex items-center justify-center hidden z-50">
        <div class="bg-white rounded-2xl p-6 w-full max-w-md mx-4">
            <h3 class="text-lg font-semibold mb-4">Zmeni≈• stav</h3>
            <input type="hidden" id="modalLeadId">
            <div class="grid grid-cols-2 gap-3">
                <button onclick="setStatus('new')" class="p-3 border rounded-xl hover:bg-gray-50">üÜï Nov√Ω</button>
                <button onclick="setStatus('ready')" class="p-3 border rounded-xl hover:bg-gray-50">‚ú® Ready</button>
                <button onclick="setStatus('contacted')" class="p-3 border rounded-xl hover:bg-gray-50">üìß Kontakt.</button>
                <button onclick="setStatus('converted')" class="p-3 border rounded-xl hover:bg-gray-50">‚úÖ Klient</button>
            </div>
            <button onclick="closeModal()" class="mt-4 w-full py-2 bg-gray-100 rounded-xl">Zru≈°i≈•</button>
        </div>
    </div>

    <script src="https://cdn.sheetjs.com/xlsx-0.20.1/package/dist/xlsx.full.min.js"></script>
    <script>
        let CLAUDE_API_KEY = localStorage.getItem('claude_api_key') || '';
        const SUPABASE_URL = 'https://eidkljfaeqvvegiponwl.supabase.co';
        const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImVpZGtsamZhZXF2dmVnaXBvbndsIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjY4NTgzNjgsImV4cCI6MjA4MjQzNDM2OH0.jFJe_IddYNiO-TOAdxhPSYtSQJlx4i6CFflB0CN4AIQ';
        const db = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

        function showTab(tab) {
            document.getElementById('panel-search').classList.toggle('hidden', tab !== 'search');
            document.getElementById('panel-import').classList.toggle('hidden', tab !== 'import');
            document.getElementById('tab-search').classList.toggle('bg-adlify-orange', tab === 'search');
            document.getElementById('tab-search').classList.toggle('text-white', tab === 'search');
            document.getElementById('tab-search').classList.toggle('bg-gray-100', tab !== 'search');
            document.getElementById('tab-import').classList.toggle('bg-adlify-orange', tab === 'import');
            document.getElementById('tab-import').classList.toggle('text-white', tab === 'import');
            document.getElementById('tab-import').classList.toggle('bg-gray-100', tab !== 'import');
        }

        document.addEventListener('DOMContentLoaded', async () => {
            await checkConnection();
            await loadLeads();
            await loadStats();
        });

        async function checkConnection() {
            try {
                const { error } = await db.from('leads').select('id', { count: 'exact', head: true });
                if (error) throw error;
                document.getElementById('dbStatus').innerHTML = '‚úÖ Pripojen√©';
                document.getElementById('dbStatus').className = 'text-sm bg-green-500/30 px-3 py-1 rounded-full';
            } catch (e) {
                document.getElementById('dbStatus').innerHTML = '‚ùå Chyba';
                document.getElementById('dbStatus').className = 'text-sm bg-red-500/30 px-3 py-1 rounded-full';
            }
        }

        async function loadStats() {
            const { data } = await db.from('leads').select('status');
            if (!data) return;
            document.getElementById('totalLeads').textContent = data.length;
            document.getElementById('newLeads').textContent = data.filter(l => l.status === 'new' || l.status === 'ready').length;
            document.getElementById('contactedLeads').textContent = data.filter(l => l.status === 'contacted').length;
            document.getElementById('convertedLeads').textContent = data.filter(l => l.status === 'converted').length;
        }

        async function loadLeads() {
            const filter = document.getElementById('statusFilter').value;
            let query = db.from('leads').select('*').order('score', { ascending: false });
            if (filter) query = query.eq('status', filter);
            const { data } = await query;
            renderLeads(data || []);
        }

        function handleSearch() {
            const trade = document.getElementById('trade').value.trim();
            const city = document.getElementById('city').value.trim();
            if (!trade || !city) return alert('Vypl≈à obe polia');
            alert('Pre "' + trade + ' ' + city + '":\n1. Hƒæadaj na Google\n2. Skop√≠ruj dom√©ny\n3. Vlo≈æ do Import');
        }

        async function handleImport() {
            const list = document.getElementById('domainList').value.trim();
            if (!list) return alert('Zadaj dom√©ny');
            const domains = list.split('\n').map(d => d.trim()).filter(d => d.includes('.'));
            let added = 0;
            for (const domain of domains) {
                const clean = domain.replace(/^https?:\/\//, '').replace(/^www\./, '').split('/')[0];
                const { data: existing } = await db.from('leads').select('id').eq('domain', clean).single();
                if (!existing) {
                    await db.from('leads').insert({ domain: clean, company_name: clean.split('.')[0], status: 'new', score: 50 });
                    added++;
                }
            }
            alert('Importovan√Ωch: ' + added);
            document.getElementById('domainList').value = '';
            await loadLeads();
            await loadStats();
        }

        function renderLeads(leads) {
            document.getElementById('resultsCount').textContent = leads.length;
            document.getElementById('emptyList').classList.toggle('hidden', leads.length > 0);
            document.getElementById('leadsList').innerHTML = leads.map(lead => 
                '<div class="px-6 py-4 border-b hover:bg-gray-50 flex items-center justify-between">' +
                    '<div>' +
                        '<div class="flex items-center gap-3 mb-1">' +
                            '<strong>' + (lead.company_name || lead.domain) + '</strong>' +
                            '<a href="https://' + lead.domain + '" target="_blank" class="text-sm text-adlify-orange">' + lead.domain + '</a>' +
                            '<span class="px-2 py-0.5 rounded text-xs ' + getStatusClass(lead.status) + '">' + getStatusText(lead.status) + '</span>' +
                        '</div>' +
                        '<div class="text-sm text-gray-500">' +
                            (lead.email ? 'üìß ' + lead.email + ' ' : '') +
                            (lead.facebook ? '<a href="' + lead.facebook + '" class="text-blue-600">FB</a> ' : '') +
                            (lead.instagram ? '<a href="' + lead.instagram + '" class="text-pink-600">IG</a>' : '') +
                        '</div>' +
                    '</div>' +
                    '<div class="flex items-center gap-2">' +
                        '<span class="px-3 py-1 rounded-full text-sm font-semibold ' + getScoreClass(lead.score) + '">‚≠ê' + lead.score + '</span>' +
                        (lead.status === 'new' ? '<button onclick="analyzeLead(\'' + lead.id + '\', \'' + lead.domain + '\')" class="px-3 py-2 bg-orange-100 text-orange-700 rounded-lg text-sm">ü§ñ Analyzova≈•</button>' : '') +
                        (lead.analysis ? '<button onclick="generatePresentation(\'' + lead.id + '\')" class="px-3 py-2 bg-purple-100 text-purple-700 rounded-lg text-sm">üìÑ Prezent√°cia</button>' : '') +
                        '<button onclick="openModal(\'' + lead.id + '\')" class="px-3 py-2 bg-gray-100 rounded-lg text-sm">‚öôÔ∏è</button>' +
                    '</div>' +
                '</div>'
            ).join('');
        }

        function getStatusClass(s) { return { new: 'bg-blue-100 text-blue-700', ready: 'bg-purple-100 text-purple-700', contacted: 'bg-orange-100 text-orange-700', converted: 'bg-green-100 text-green-700' }[s] || 'bg-gray-100'; }
        function getStatusText(s) { return { new: 'üÜï Nov√Ω', ready: '‚ú® Ready', contacted: 'üìß Kontakt.', converted: '‚úÖ Klient' }[s] || s; }
        function getScoreClass(score) { return score >= 80 ? 'bg-green-100 text-green-700' : score >= 60 ? 'bg-yellow-100 text-yellow-700' : 'bg-red-100 text-red-700'; }

        function openSettings() { document.getElementById('settingsApiKey').value = CLAUDE_API_KEY; document.getElementById('settingsModal').classList.remove('hidden'); }
        function closeSettings() { document.getElementById('settingsModal').classList.add('hidden'); }
        function saveSettings() { CLAUDE_API_KEY = document.getElementById('settingsApiKey').value.trim(); localStorage.setItem('claude_api_key', CLAUDE_API_KEY); alert('‚úÖ Ulo≈æen√©'); closeSettings(); }
        function openModal(id) { document.getElementById('modalLeadId').value = id; document.getElementById('statusModal').classList.remove('hidden'); }
        function closeModal() { document.getElementById('statusModal').classList.add('hidden'); }
        async function setStatus(status) {
            await db.from('leads').update({ status }).eq('id', document.getElementById('modalLeadId').value);
            closeModal(); await loadLeads(); await loadStats();
        }

        document.getElementById('settingsModal').onclick = e => { if (e.target.id === 'settingsModal') closeSettings(); };
        document.getElementById('statusModal').onclick = e => { if (e.target.id === 'statusModal') closeModal(); };

        async function analyzeLead(id, domain) {
            if (!CLAUDE_API_KEY) { alert('Nastav Claude API kƒæ√∫ƒç v ‚öôÔ∏è'); openSettings(); return; }
            await db.from('leads').update({ status: 'analyzing' }).eq('id', id);
            await loadLeads();
            try {
                let content = '';
                try {
                    const res = await fetch('https://api.allorigins.win/raw?url=' + encodeURIComponent('https://' + domain));
                    if (res.ok) {
                        const html = await res.text();
                        const doc = new DOMParser().parseFromString(html, 'text/html');
                        doc.querySelectorAll('script,style,nav,footer').forEach(e => e.remove());
                        content = (doc.body?.innerText || '').substring(0, 5000);
                    }
                } catch(e) {}
                
                const apiRes = await fetch('https://api.anthropic.com/v1/messages', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json', 'x-api-key': CLAUDE_API_KEY, 'anthropic-version': '2023-06-01', 'anthropic-dangerous-direct-browser-access': 'true' },
                    body: JSON.stringify({
                        model: 'claude-sonnet-4-20250514',
                        max_tokens: 2000,
                        messages: [{ role: 'user', content: 'Analyzuj firmu ' + domain + '. ' + (content ? 'Web: ' + content : '') + '\n\nVr√°≈• JSON: {"company_name":"","description":"","services":[],"strengths":[],"weaknesses":[],"potential":"","keywords":[{"keyword":"","volume":100,"difficulty":"easy"}],"roi_estimate":{"new_customers":"30-50","avg_order":"80‚Ç¨","monthly_revenue":"3000‚Ç¨"}}' }]
                    })
                });
                
                const data = await apiRes.json();
                const text = data.content[0].text;
                const match = text.match(/\{[\s\S]*\}/);
                const analysis = JSON.parse(match ? match[0] : text);
                
                await db.from('leads').update({ status: 'ready', analysis, company_name: analysis.company_name || domain.split('.')[0], score: 80 }).eq('id', id);
                alert('‚úÖ Hotovo!');
            } catch(e) {
                alert('‚ùå Chyba: ' + e.message);
                await db.from('leads').update({ status: 'new' }).eq('id', id);
            }
            await loadLeads(); await loadStats();
        }

        async function generatePresentation(id) {
            const { data: lead } = await db.from('leads').select('*').eq('id', id).single();
            if (!lead?.analysis) return alert('Najprv analyzuj');
            const a = lead.analysis;
            const html = getPresentationHTML(lead, a);
            const win = window.open('', '_blank');
            win.document.write(html);
            win.document.close();
        }

        function getPresentationHTML(lead, a) {
            var name = a.company_name || lead.domain;
            var services = (a.services || []).join(', ');
            var strengths = (a.strengths || []).map(function(s) { return '<div class="card"><p>' + s + '</p></div>'; }).join('');
            var weaknesses = (a.weaknesses || []).map(function(w) { return '<div class="card pink"><p>' + w + '</p></div>'; }).join('');
            var keywords = (a.keywords || []).map(function(k) { 
                var diff = k.difficulty || 'medium';
                var diffHtml = diff === 'easy' ? '<span style="color:#4CAF50">‚óè N√≠zka</span>' : (diff === 'hard' ? '<span style="color:#f44">‚óè Vysok√°</span>' : '<span style="color:#FF9800">‚óè Stredn√°</span>');
                return '<tr><td><strong>' + k.keyword + '</strong></td><td>' + (k.volume || 100) + '/mes</td><td>' + diffHtml + '</td></tr>'; 
            }).join('');
            
            return '<!DOCTYPE html><html lang="sk"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>N√°vrh - ' + name + '</title>' +
                '<style>' +
                '@import url("https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap");' +
                ':root{--orange:#FF6B35;--pink:#E91E63;--purple:#9C27B0;--dark:#1a1a2e;--light:#f8f9fa;--gray:#6c757d;--gradient:linear-gradient(135deg,#FF6B35 0%,#E91E63 50%,#9C27B0 100%)}' +
                '*{margin:0;padding:0;box-sizing:border-box}' +
                'body{font-family:Poppins,sans-serif;background:var(--light);color:var(--dark);line-height:1.6}' +
                '.slide{max-width:1100px;margin:0 auto 40px;background:white;border-radius:24px;box-shadow:0 20px 60px rgba(0,0,0,0.1);overflow:hidden;page-break-after:always}' +
                '.slide-title{min-height:500px;background:var(--gradient);display:flex;flex-direction:column;justify-content:center;align-items:center;text-align:center;padding:60px;position:relative}' +
                '.slide-title h1{font-size:3rem;font-weight:700;color:white;margin-bottom:20px}' +
                '.slide-title .subtitle{font-size:1.3rem;color:rgba(255,255,255,0.9);font-weight:300}' +
                '.company-badge{background:rgba(255,255,255,0.2);padding:12px 35px;border-radius:50px;margin-top:35px}' +
                '.company-badge span{color:white;font-weight:600;font-size:1.1rem}' +
                '.adlify-logo{position:absolute;bottom:25px;right:35px;color:rgba(255,255,255,0.8);font-size:0.85rem;font-weight:600}' +
                '.slide-content{padding:45px}' +
                '.slide-header{display:flex;align-items:center;gap:15px;margin-bottom:35px;padding-bottom:18px;border-bottom:3px solid;border-image:var(--gradient) 1}' +
                '.slide-header .number{width:45px;height:45px;background:var(--gradient);border-radius:50%;display:flex;align-items:center;justify-content:center;color:white;font-weight:700;font-size:1.2rem}' +
                '.slide-header h2{font-size:1.8rem;font-weight:600}' +
                '.cards-grid{display:grid;grid-template-columns:1fr 1fr;gap:20px}' +
                '.card{background:var(--light);border-radius:14px;padding:25px;border-left:4px solid var(--orange)}' +
                '.card.pink{border-left-color:var(--pink)}' +
                '.card.purple{border-left-color:var(--purple)}' +
                '.card h3{font-size:1rem;font-weight:600;margin-bottom:10px;display:flex;align-items:center;gap:8px}' +
                '.card p{color:var(--gray);font-size:0.9rem}' +
                '.opportunities{display:grid;grid-template-columns:repeat(3,1fr);gap:18px;margin-top:25px}' +
                '.opportunity{background:var(--gradient);border-radius:14px;padding:22px;color:white;text-align:center}' +
                '.opportunity .icon{font-size:2rem;margin-bottom:12px}' +
                '.opportunity h4{font-size:0.95rem;font-weight:600;margin-bottom:6px}' +
                '.opportunity p{font-size:0.8rem;opacity:0.9}' +
                '.keywords-section{background:var(--dark);border-radius:14px;padding:25px;color:white;margin-top:25px}' +
                '.keywords-section h4{font-size:1rem;margin-bottom:18px}' +
                '.keywords-table{width:100%;border-collapse:collapse}' +
                '.keywords-table th{text-align:left;padding:10px;border-bottom:1px solid rgba(255,255,255,0.2);font-weight:500;font-size:0.8rem;color:rgba(255,255,255,0.7)}' +
                '.keywords-table td{padding:10px;border-bottom:1px solid rgba(255,255,255,0.1);font-size:0.85rem}' +
                '.packages-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:18px;margin-bottom:25px}' +
                '.package-card{background:white;border-radius:14px;padding:22px;border:2px solid #eee;position:relative}' +
                '.package-card.recommended{border-color:var(--orange);box-shadow:0 8px 30px rgba(255,107,53,0.2)}' +
                '.package-card.recommended::before{content:"‚≠ê Odpor√∫ƒçame";position:absolute;top:-10px;left:50%;transform:translateX(-50%);background:var(--gradient);color:white;font-size:0.7rem;font-weight:600;padding:4px 12px;border-radius:15px}' +
                '.package-card h3{font-size:1.1rem;margin-bottom:5px}' +
                '.package-card .price{font-size:2rem;font-weight:700;background:var(--gradient);-webkit-background-clip:text;-webkit-text-fill-color:transparent}' +
                '.package-card .period{color:var(--gray);font-size:0.85rem;margin-bottom:12px}' +
                '.package-features{list-style:none}' +
                '.package-features li{padding:6px 0;font-size:0.85rem}' +
                '.package-features li::before{content:"‚úì ";color:#4CAF50;font-weight:bold}' +
                '.budget-section{background:#fff8f0;border-radius:14px;padding:22px;border:2px dashed var(--orange)}' +
                '.budget-section h4{color:var(--orange);font-size:0.95rem;margin-bottom:12px}' +
                '.budget-options{display:grid;grid-template-columns:repeat(3,1fr);gap:12px}' +
                '.budget-option{background:white;border-radius:10px;padding:15px;text-align:center}' +
                '.budget-option .amount{font-size:1.3rem;font-weight:700}' +
                '.budget-option .desc{font-size:0.75rem;color:var(--gray);margin-top:4px}' +
                '.budget-option.recommended{border:2px solid var(--orange)}' +
                '.roi-grid{display:grid;grid-template-columns:repeat(4,1fr);gap:18px}' +
                '.roi-card{background:var(--gradient);border-radius:14px;padding:25px;text-align:center;color:white}' +
                '.roi-card .value{font-size:2rem;font-weight:700;margin-bottom:5px}' +
                '.roi-card .label{font-size:0.8rem;opacity:0.9}' +
                '.slide-cta{min-height:400px;background:var(--gradient);display:flex;flex-direction:column;justify-content:center;align-items:center;text-align:center;padding:50px;color:white}' +
                '.slide-cta h2{font-size:2.5rem;font-weight:700;margin-bottom:15px}' +
                '.slide-cta p{font-size:1.1rem;opacity:0.9;max-width:600px;margin-bottom:35px}' +
                '.cta-buttons{display:flex;gap:15px}' +
                '.btn{padding:14px 35px;border-radius:50px;font-weight:600;font-size:1rem;text-decoration:none}' +
                '.btn-white{background:white;color:var(--purple)}' +
                '.btn-outline{border:2px solid white;color:white;background:transparent}' +
                '.contact-info{margin-top:30px;font-size:0.95rem}' +
                '.contact-info a{color:white}' +
                '</style></head><body>' +
                
                '<div class="slide"><div class="slide-title">' +
                '<h1>' + name + '</h1>' +
                '<div class="subtitle">N√°vrh online marketingovej strat√©gie</div>' +
                '<div class="company-badge"><span>üåê ' + lead.domain + '</span></div>' +
                '<div class="adlify-logo">ADLIFY</div>' +
                '</div></div>' +
                
                '<div class="slide"><div class="slide-content">' +
                '<div class="slide-header"><div class="number">1</div><h2>O va≈°om biznise</h2></div>' +
                '<div class="cards-grid">' +
                '<div class="card"><h3>üëã Kto ste</h3><p>' + (a.description || 'Profesion√°lna firma poskytuj√∫ca kvalitn√© slu≈æby.') + '</p></div>' +
                '<div class="card pink"><h3>üõ†Ô∏è Va≈°e slu≈æby</h3><p>' + services + '</p></div>' +
                '</div>' +
                '<div class="opportunities">' +
                '<div class="opportunity"><div class="icon">üéØ</div><h4>Cielen√° reklama</h4><p>Oslov√≠me z√°kazn√≠kov, ktor√≠ pr√°ve hƒæadaj√∫ va≈°e slu≈æby</p></div>' +
                '<div class="opportunity"><div class="icon">üìà</div><h4>Merateƒæn√Ω v√Ωkon</h4><p>Presn√© d√°ta o n√°v≈°tevnosti a konverzi√°ch</p></div>' +
                '<div class="opportunity"><div class="icon">üí∞</div><h4>Vysok√° n√°vratnos≈•</h4><p>Ka≈æd√© euro investovan√© do reklamy sa vr√°ti</p></div>' +
                '</div>' +
                '</div></div>' +
                
                '<div class="slide"><div class="slide-content">' +
                '<div class="slide-header"><div class="number">2</div><h2>ƒåo sme zistili</h2></div>' +
                '<div class="cards-grid">' +
                '<div><h3 style="color:#4CAF50;margin-bottom:15px">‚úÖ Siln√© str√°nky</h3>' + strengths + '</div>' +
                '<div><h3 style="color:var(--orange);margin-bottom:15px">‚ö†Ô∏è Pr√≠le≈æitosti na zlep≈°enie</h3>' + weaknesses + '</div>' +
                '</div>' +
                '<div class="keywords-section"><h4>üîç Top kƒæ√∫ƒçov√© slov√° pre va≈°u firmu</h4>' +
                '<table class="keywords-table"><thead><tr><th>Kƒæ√∫ƒçov√© slovo</th><th>Hƒæadanos≈•</th><th>Konkurencia</th></tr></thead>' +
                '<tbody>' + keywords + '</tbody></table></div>' +
                '</div></div>' +
                
                '<div class="slide"><div class="slide-content">' +
                '<div class="slide-header"><div class="number">3</div><h2>N√°vrh spolupr√°ce</h2></div>' +
                '<div class="packages-grid">' +
                '<div class="package-card"><h3>üöÄ Starter</h3><div class="price">149‚Ç¨</div><div class="period">/ mesiac</div><ul class="package-features"><li>1 reklamn√° platforma</li><li>1 kampa≈à</li><li>2 reklamn√© vizu√°ly</li><li>Mesaƒçn√Ω report</li><li>Email podpora</li></ul></div>' +
                '<div class="package-card recommended"><h3>‚≠ê Pro</h3><div class="price">249‚Ç¨</div><div class="period">/ mesiac</div><ul class="package-features"><li>2 platformy (FB/IG + Google)</li><li>3 kampane s√∫ƒçasne</li><li>4 reklamn√© vizu√°ly</li><li>A/B testovanie</li><li>Detailn√Ω report</li></ul></div>' +
                '<div class="package-card"><h3>üíé Enterprise</h3><div class="price">399‚Ç¨</div><div class="period">/ mesiac</div><ul class="package-features"><li>V≈°etky platformy + remarketing</li><li>5 kampan√≠ s√∫ƒçasne</li><li>8 reklamn√Ωch vizu√°lov</li><li>Strategick√© konzult√°cie</li><li>Prioritn√° podpora</li></ul></div>' +
                '</div>' +
                '<div class="budget-section"><h4>üí∞ Odpor√∫ƒçan√Ω reklamn√Ω rozpoƒçet (plat√≠te priamo Googlu/Mete)</h4>' +
                '<div class="budget-options">' +
                '<div class="budget-option"><div class="amount">250‚Ç¨</div><div class="desc">Konzervat√≠vny ≈°tart</div></div>' +
                '<div class="budget-option recommended"><div class="amount">450‚Ç¨</div><div class="desc">Optim√°lny v√Ωkon</div></div>' +
                '<div class="budget-option"><div class="amount">700‚Ç¨</div><div class="desc">Agres√≠vny rast</div></div>' +
                '</div></div>' +
                '</div></div>' +
                
                '<div class="slide"><div class="slide-content">' +
                '<div class="slide-header"><div class="number">4</div><h2>Predpokladan√° n√°vratnos≈•</h2></div>' +
                '<p style="color:var(--gray);margin-bottom:25px">Pri bal√≠ku Pro (249‚Ç¨) a odpor√∫ƒçanom rozpoƒçte 450‚Ç¨/mesiac:</p>' +
                '<div class="roi-grid">' +
                '<div class="roi-card"><div class="value">40,000+</div><div class="label">Zobrazen√≠ reklamy</div></div>' +
                '<div class="roi-card"><div class="value">1,300</div><div class="label">Kliknut√≠ na web</div></div>' +
                '<div class="roi-card"><div class="value">' + (a.roi_estimate?.new_customers || '50-80') + '</div><div class="label">Nov√Ωch z√°kazn√≠kov</div></div>' +
                '<div class="roi-card"><div class="value">5-8x</div><div class="label">N√°vratnos≈•</div></div>' +
                '</div>' +
                '<div style="background:var(--light);border-radius:14px;padding:25px;margin-top:25px">' +
                '<h4 style="margin-bottom:12px">üìä Pr√≠klad v√Ωpoƒçtu n√°vratnosti:</h4>' +
                '<p style="color:var(--gray);line-height:1.8"><strong>Invest√≠cia:</strong> 249‚Ç¨ + 450‚Ç¨ = <strong>699‚Ç¨/mesiac</strong><br>' +
                '<strong>Nov√≠ z√°kazn√≠ci:</strong> ~60 mesaƒçne<br>' +
                '<strong>Priemern√° √∫trata:</strong> ' + (a.roi_estimate?.avg_order || '100‚Ç¨') + '<br>' +
                '<strong>Tr≈æba z reklamy:</strong> <strong>' + (a.roi_estimate?.monthly_revenue || '6,000‚Ç¨') + '</strong><br>' +
                '<strong style="color:#4CAF50">ƒåist√° n√°vratnos≈•: +' + (parseInt((a.roi_estimate?.monthly_revenue || '6000').replace(/[^0-9]/g,'')) - 699) + '‚Ç¨</strong></p>' +
                '</div>' +
                '</div></div>' +
                
                '<div class="slide"><div class="slide-cta">' +
                '<h2>Zaƒçnime spolupr√°cu</h2>' +
                '<p>Dohodnite si nez√°v√§zn√∫ konzult√°ciu a preberieme, ako v√°m vieme pom√¥c≈• z√≠ska≈• viac z√°kazn√≠kov.</p>' +
                '<div class="cta-buttons">' +
                '<a href="mailto:info@adlify.eu?subject=M√°m z√°ujem - ' + name + '" class="btn btn-white">‚úì M√°m z√°ujem</a>' +
                '<a href="mailto:info@adlify.eu?subject=Ot√°zka - ' + name + '" class="btn btn-outline">M√°m ot√°zky</a>' +
                '</div>' +
                '<div class="contact-info">üìß info@adlify.eu &nbsp;|&nbsp; üåê adlify.eu</div>' +
                '</div></div>' +
                
                '</body></html>';
        }
    </script>
</body>
</html>
